import{j as e,I as L,n as a}from"./index.CFX3P5ff.js";import{r as t}from"./index.DhYZZe0J.js";function k(){const[h,f]=t.useState(""),[s,p]=t.useState(!1),[x,v]=t.useState(""),[g,w]=t.useState(""),[n,b]=t.useState(""),l=t.useRef(null),c=t.useRef(null);function r(){l.current?.value?f(l.current.value):f("")}function i(){c.current?.value?w(c.current.value):w("")}async function y(){const o=window.location.origin.includes(":4321")?"http://192.168.20.27:3030":window.location.origin;try{const d=btoa(JSON.stringify({url:h,base:o,posters:!1,customListName:g.length?g:void 0})),u=await fetch(`${o}/verify/${d}`,{headers:{"Cache-Control":"max-age=3600, stale-while-revalidate=600"}});if(!u.ok){const C=await u.json();a.error(C);return}const m=await u.json();console.log({manifestUrl:m}),b(m)}catch(d){a.error(`Try again in a few seconds: ${d.message}`)}}async function j(){if(r(),h.length===0){a.error("Please enter a valid URL");return}p(!0),await y(),n.length&&v(n),p(!1)}async function N(){try{await navigator.clipboard.writeText(n),a.success("Copied, paste in Stremio!")}catch(o){a.error(o.message)}}async function U(){window.location.href=n}return e.jsxs("div",{children:[e.jsx(L,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsx("div",{className:"text-base",children:"A Letterboxd URL containing a list of posters (including any sorting!):"}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"https://letterboxd.com/almosteffective/watchlist",className:"w-full border border-black text-tailwind rounded text-xl px-2 py-1",ref:l,onPaste:r,onKeyDown:r,onKeyUp:r,onBlur:r,onFocus:r})}),e.jsx("div",{className:"text-base",children:"Set a custom list if you'd like (leave empty to auto-generate):"}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"My Cool List Name",className:"w-full border border-black text-tailwind rounded text-xl px-2 py-1",ref:c,onPaste:i,onKeyDown:i,onKeyUp:i,onBlur:i,onFocus:i})}),e.jsxs("div",{className:"grid gap-1 grid-cols-2 grid-rows-2",children:[e.jsx("button",{className:"col-span-2 grow border border-white bg-white uppercase text-tailwind text-lg p-2 rounded font-bold hover:bg-tailwind hover:text-white hover:underline",onClick:j,disabled:s,children:s===!1?"Generate Manifest":"Validating..."}),e.jsx("button",{className:"grow border border-white bg-white uppercase text-tailwind text-lg p-2 rounded font-bold hover:bg-tailwind hover:text-white hover:underline",onClick:U,hidden:s||n.length===0,children:s===!1?"Install":"Validating..."}),e.jsx("button",{className:"grow border border-transparent hover:border-white bg-tailwind uppercase text-white text-lg p-2 rounded font-normal",onClick:N,hidden:s||n.length===0,children:s===!1?"Copy":"Validating..."})]}),e.jsxs("div",{className:"",children:[e.jsx("div",{children:e.jsx("a",{href:x,children:x})}),e.jsx("div",{children:window.navigator.userActivation.hasBeenActive?"User has been active":"User has not been active"}),e.jsx("div",{children:window.navigator.userActivation.isActive?"User is active":"User is not active"})]})]})]})}export{k as default};
