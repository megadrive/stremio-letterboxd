import{j as r}from"./jsx-runtime.K1e75nIr.js";import{r as i}from"./index.NEDEFKed.js";function y(){const[a,c]=i.useState(""),[n,o]=i.useState(!1),s=i.useRef(null);function t(){s.current?.value?c(s.current.value):c("")}async function p(e){const l=/https:\/\/(www\.)?letterboxd\.com\/([A-Za-z0-9-_]+)(\/([A-Za-z0-9-_]+)\/([A-Za-z0-9-_]+))?/gi,w=/https:\/\/boxd\.it\/.+/gi;console.log(e),w.test(e)&&(console.log(`boxdit_url: ${e}`),e=await(await fetch(`/url/${encodeURIComponent(e)}`)).json(),console.log(`resolved url: ${e}`));const b=[...e.matchAll(l)];let[,,g,,u,f]=b[0];return u||(u="watchlist"),`${g}${f?`${`|${f}`}`:""}`}async function d(){try{const e=await p(a);return`stremio://${new URL(window.location.href).host}/${e}/manifest.json`}catch{alert("Try again in a few seconds.")}return""}async function h(){if(o(!0),a.length){t();const e=await d();await navigator.clipboard.writeText(e).then(()=>alert("Copied, paste in Stremio!")).catch(l=>{o(!1)})}o(!1)}async function x(){try{if(o(!0),a.length){t();const e=await d();window.location.href=e}o(!1)}catch{o(!1)}}return r.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[r.jsx("div",{className:"text-base",children:"A user's Letterboxd URL or a List URL:"}),r.jsx("div",{children:r.jsx("input",{type:"text",placeholder:"https://letterboxd.com/almosteffective",className:"w-full border border-black text-tailwind rounded text-xl px-2 py-1",ref:s,onKeyDown:t,onKeyUp:t,onChange:t,onBlur:t,onPaste:t})}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{className:"grow border border-white bg-white uppercase text-tailwind text-lg p-2 rounded font-bold hover:bg-tailwind hover:text-white hover:underline",onClick:x,disabled:n,children:n===!1?"Install":"..."}),r.jsx("button",{className:"grow border border-transparent hover:border-white bg-tailwind uppercase text-white text-lg p-2 rounded font-normal",onClick:h,disabled:n,children:n===!1?"Copy":"..."})]})]})}export{y as default};
