import{j as t}from"./jsx-runtime.K1e75nIr.js";import{r as n}from"./index.NEDEFKed.js";function y(){const[u,i]=n.useState(""),[o,r]=n.useState(!1),[h,l]=n.useState(""),s=n.useRef(null);function c(){s.current?.value?i(s.current.value):i("")}async function p(e){const a=/^https:\/\/(www\.)?letterboxd\.com\//gi,b=/^https:\/\/boxd\.it\/.+/gi,g=e;if(b.test(e)){console.log(`boxdit url: ${e}`);try{const f=await fetch(`/url/${encodeURIComponent(e)}`);if(!f.ok)return;e=await f.json(),console.log(`resolved url: ${e}`)}catch{console.error("Error occurred while resolving.");return}}if(!a.test(e)){console.error(`bad resolved url: ${e} from ${g}`);return}return encodeURIComponent(e)}async function d(){try{const e=await p(u);if(!e)throw Error("Conversion failed.");return`stremio://${new URL(window.location.href).host}/${e}/manifest.json`}catch(e){alert(`Try again in a few seconds: ${e.message}`)}return""}async function x(){r(!0),c();const e=await d();e.length&&(l(e),await navigator.clipboard.writeText(e).then(()=>alert("Copied, paste in Stremio!")).catch(a=>{r(!1)})),r(!1)}async function w(){try{r(!0),c();const e=await d();e.length&&(l(e),window.location.href=e,r(!1))}catch{r(!1)}}return t.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[t.jsx("div",{className:"text-base",children:"A Letterboxd URL containing a list of posters (including any sorting!):"}),t.jsx("div",{children:t.jsx("input",{type:"text",placeholder:"https://letterboxd.com/almosteffective/watchlist",className:"w-full border border-black text-tailwind rounded text-xl px-2 py-1",ref:s})}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{className:"grow border border-white bg-white uppercase text-tailwind text-lg p-2 rounded font-bold hover:bg-tailwind hover:text-white hover:underline",onClick:w,disabled:o,children:o===!1?"Install":"..."}),t.jsx("button",{className:"grow border border-transparent hover:border-white bg-tailwind uppercase text-white text-lg p-2 rounded font-normal",onClick:x,disabled:o,children:o===!1?"Copy":"..."})]}),t.jsx("div",{className:"hidden",children:h})]})}export{y as default};
