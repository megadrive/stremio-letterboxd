import{j as e,I as j,n as a}from"./index.CaWQtM3j.js";import{r as n}from"./index.NEDEFKed.js";function C(){const[c,p]=n.useState(""),[l,r]=n.useState(!1),[w,h]=n.useState(""),[m,x]=n.useState(""),d=n.useRef(null),u=n.useRef(null);function s(){d.current?.value?p(d.current.value):p("")}function o(){u.current?.value?x(u.current.value):x("")}async function g(){const t=window.location.origin.includes(":4321")?"http://localhost:3030":window.location.origin;try{const i=btoa(JSON.stringify({url:c,base:t,posters:!1,customListName:m.length?m:void 0})),f=await fetch(`${t}/verify/${i}`,{headers:{"Cache-Control":"max-age=3600, stale-while-revalidate=600"}});if(!f.ok){const y=await f.json();a.error(y);return}return await f.json()}catch(i){a.error(`Try again in a few seconds: ${i.message}`)}return""}async function b(){if(s(),c.length===0){a.error("Please enter a valid URL");return}r(!0);const t=await g();t.length&&(h(t),await navigator.clipboard.writeText(t).then(()=>a.success("Copied, paste in Stremio!")).catch(i=>{a.error(i.message),r(!1)})),r(!1)}async function v(){try{if(s(),c.length===0){a.error("Please enter a valid URL");return}r(!0);const t=await g();t.length&&(h(t),window.location.href=t,r(!1))}catch{r(!1)}}return e.jsxs("div",{children:[e.jsx(j,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsx("div",{className:"text-base",children:"A Letterboxd URL containing a list of posters (including any sorting!):"}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"https://letterboxd.com/almosteffective/watchlist",className:"w-full border border-black text-tailwind rounded text-xl px-2 py-1",ref:d,onPaste:s,onKeyDown:s,onKeyUp:s,onBlur:s,onFocus:s})}),e.jsx("div",{className:"text-base",children:"Set a custom list if you'd like (leave empty to auto-generate):"}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"My Cool List Name",className:"w-full border border-black text-tailwind rounded text-xl px-2 py-1",ref:u,onPaste:o,onKeyDown:o,onKeyUp:o,onBlur:o,onFocus:o})}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{className:"grow border border-white bg-white uppercase text-tailwind text-lg p-2 rounded font-bold hover:bg-tailwind hover:text-white hover:underline",onClick:v,disabled:l,children:l===!1?"Install":"Validating..."}),e.jsx("button",{className:"grow border border-transparent hover:border-white bg-tailwind uppercase text-white text-lg p-2 rounded font-normal",onClick:b,disabled:l,children:l===!1?"Copy":"Validating..."})]}),e.jsx("div",{className:"hidden",children:w})]})]})}export{C as default};
