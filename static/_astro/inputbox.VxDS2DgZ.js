import{j as o}from"./jsx-runtime.K1e75nIr.js";import{r as i}from"./index.NEDEFKed.js";function y(){const[s,c]=i.useState(""),[n,r]=i.useState(!1),a=i.useRef(null);function t(){a.current?.value?c(a.current.value):c("")}async function p(e){const l=/https:\/\/(www\.)?letterboxd\.com\/([A-Za-z0-9-_]+)(\/([A-Za-z0-9-_]+)\/([A-Za-z0-9-_]+))?/gi,w=/https:\/\/boxd\.it\/.+/gi;console.log(e),w.test(e)&&(console.log(`boxdit_url: ${e}`),e=await(await fetch(`/url/${encodeURIComponent(e)}`)).json(),console.log(`resolved url: ${e}`));const b=[...e.matchAll(l)];let[,,g,,u,f]=b[0];return u||(u="watchlist"),`${g}${f?`${`|${f}`}`:""}`}async function d(){try{const e=await p(s);return`stremio://${new URL(window.location.href).host}/${e}/manifest.json`}catch{alert("Try again in a few seconds.")}return""}async function h(){if(r(!0),s.length){t();const e=await d();await navigator.clipboard.writeText(e).then(()=>alert("Copied, paste in Stremio!")).catch(l=>{})}r(!1)}async function x(){if(r(!0),s.length){t();const e=await d();window.location.href=e}r(!1)}return o.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[o.jsx("div",{className:"text-base",children:"A user's Letterboxd URL or a List URL:"}),o.jsx("div",{children:o.jsx("input",{type:"text",placeholder:"https://letterboxd.com/almosteffective",className:"w-full border border-black text-tailwind rounded text-xl px-2 py-1",ref:a,onKeyDown:t,onKeyUp:t,onChange:t,onBlur:t,onPaste:t})}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{className:"grow border border-white bg-white uppercase text-tailwind text-lg p-2 rounded font-bold hover:bg-tailwind hover:text-white hover:underline",onClick:x,disabled:n,children:n===!1?"Install":"..."}),o.jsx("button",{className:"grow border border-transparent hover:border-white bg-tailwind uppercase text-white text-lg p-2 rounded font-normal",onClick:h,disabled:n,children:n===!1?"Copy":"..."})]})]})}export{y as default};
